echo ""
echo ""
echo -e "Muhammad Rizki █▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀█"
echo -e "█                     » HOME Credit Sqooping «                     █"
echo -e "█▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ v-0.0.1 ▄▄▄█ Muhammad Rizki"
echo ""
echo "     Sqooping IS The Another Level Store Data    "
echo ""
echo ""

pass=$(. ./credential.sh)

##############################################################################
sqoop import-all-tables --connect jdbc:postgresql://dbshost:port/homecredit \
-m 1 \
--username insidertech \
--password $pass \
--warehouse-dir  /user/insiderhack/HomeCredit \
-- --schema public
##############################################################################

hive -e "CREATE EXTERNAL TABLE IF NOT EXISTS home_credit_muhammadrizki.application_train(SK_ID_CURR int, TARGET int, NAME_CONTRACT_TYPE string, CODE_GENDER string, FLAG_OWN_CAR string, FLAG_OWN_REALTY string, CNT_CHILDREN int, AMT_INCOME_TOTAL double, AMT_CREDIT double, AMT_ANNUITY double, AMT_GOODS_PRICE double, NAME_TYPE_SUITE string, NAME_INCOME_TYPE string, NAME_EDUCATION_TYPE string, NAME_FAMILY_STATUS string, NAME_HOUSING_TYPE string, REGION_POPULATION_RELATIVE double, DAYS_BIRTH int, DAYS_EMPLOYED int, DAYS_REGISTRATION double, DAYS_ID_PUBLISH int, OWN_CAR_AGE double, FLAG_MOBIL int, FLAG_EMP_PHONE int, FLAG_WORK_PHONE int, FLAG_CONT_MOBILE int, FLAG_PHONE int, FLAG_EMAIL int, OCCUPATION_TYPE string, CNT_FAM_MEMBERS double, REGION_RATING_CLIENT int, REGION_RATING_CLIENT_W_CITY int, WEEKDAY_APPR_PROCESS_START string, HOUR_APPR_PROCESS_START int, REG_REGION_NOT_LIVE_REGION int, REG_REGION_NOT_WORK_REGION int, LIVE_REGION_NOT_WORK_REGION int, REG_CITY_NOT_LIVE_CITY int, REG_CITY_NOT_WORK_CITY int, LIVE_CITY_NOT_WORK_CITY int, ORGANIZATION_TYPE string, EXT_SOURCE_1 double, EXT_SOURCE_2 double, EXT_SOURCE_3 double, APARTMENTS_AVG double, BASEMENTAREA_AVG double, YEARS_BEGINEXPLUATATION_AVG double, YEARS_BUILD_AVG double, COMMONAREA_AVG double, ELEVATORS_AVG double, ENTRANCES_AVG double, FLOORSMAX_AVG double, FLOORSMIN_AVG double, LANDAREA_AVG double, LIVINGAPARTMENTS_AVG double, LIVINGAREA_AVG double, NONLIVINGAPARTMENTS_AVG double, NONLIVINGAREA_AVG double, APARTMENTS_MODE double, BASEMENTAREA_MODE double, YEARS_BEGINEXPLUATATION_MODE double, YEARS_BUILD_MODE double, COMMONAREA_MODE double, ELEVATORS_MODE double, ENTRANCES_MODE double, FLOORSMAX_MODE double, FLOORSMIN_MODE double, LANDAREA_MODE double, LIVINGAPARTMENTS_MODE double, LIVINGAREA_MODE double, NONLIVINGAPARTMENTS_MODE double, NONLIVINGAREA_MODE double, APARTMENTS_MEDI double, BASEMENTAREA_MEDI double, YEARS_BEGINEXPLUATATION_MEDI double, YEARS_BUILD_MEDI double, COMMONAREA_MEDI double, ELEVATORS_MEDI double, ENTRANCES_MEDI double, FLOORSMAX_MEDI double, FLOORSMIN_MEDI double, LANDAREA_MEDI double, LIVINGAPARTMENTS_MEDI double, LIVINGAREA_MEDI double, NONLIVINGAPARTMENTS_MEDI double, NONLIVINGAREA_MEDI double, FONDKAPREMONT_MODE string, HOUSETYPE_MODE string, TOTALAREA_MODE double, WALLSMATERIAL_MODE string, EMERGENCYSTATE_MODE string, OBS_30_CNT_SOCIAL_CIRCLE double, DEF_30_CNT_SOCIAL_CIRCLE double, OBS_60_CNT_SOCIAL_CIRCLE double, DEF_60_CNT_SOCIAL_CIRCLE double, DAYS_LAST_PHONE_CHANGE double, FLAG_DOCUMENT_2 int, FLAG_DOCUMENT_3 int, FLAG_DOCUMENT_4 int, FLAG_DOCUMENT_5 int, FLAG_DOCUMENT_6 int, FLAG_DOCUMENT_7 int, FLAG_DOCUMENT_8 int, FLAG_DOCUMENT_9 int, FLAG_DOCUMENT_10 int, FLAG_DOCUMENT_11 int, FLAG_DOCUMENT_12 int, FLAG_DOCUMENT_13 int, FLAG_DOCUMENT_14 int, FLAG_DOCUMENT_15 int, FLAG_DOCUMENT_16 int, FLAG_DOCUMENT_17 int, FLAG_DOCUMENT_18 int, FLAG_DOCUMENT_19 int, FLAG_DOCUMENT_20 int, FLAG_DOCUMENT_21 int, AMT_REQ_CREDIT_BUREAU_HOUR double, AMT_REQ_CREDIT_BUREAU_DAY double, AMT_REQ_CREDIT_BUREAU_WEEK double, AMT_REQ_CREDIT_BUREAU_MON double, AMT_REQ_CREDIT_BUREAU_QRT double, AMT_REQ_CREDIT_BUREAU_YEAR double) ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' location 'hdfs:///user/insiderhack/HomeCredit/application_train';"

hive -e "CREATE EXTERNAL TABLE IF NOT EXISTS home_credit_muhammadrizki.bureau(SK_ID_CURR int, SK_ID_BUREAU int, CREDIT_ACTIVE string, CREDIT_CURRENCY string, DAYS_CREDIT int, CREDIT_DAY_OVERDUE int, DAYS_CREDIT_ENDDATE double, DAYS_ENDDATE_FACT double, AMT_CREDIT_MAX_OVERDUE double, CNT_CREDIT_PROLONG int, AMT_CREDIT_SUM double, AMT_CREDIT_SUM_DEBT double, AMT_CREDIT_SUM_LIMIT double, AMT_CREDIT_SUM_OVERDUE double, CREDIT_TYPE string, DAYS_CREDIT_UPDATE int, AMT_ANNUITY double) ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' location 'hdfs:///user/insiderhack/HomeCredit/bureau';"

hive -e "CREATE EXTERNAL TABLE IF NOT EXISTS home_credit_muhammadrizki.bureau_balance(SK_ID_BUREAU int, MONTHS_BALANCE int, STATUS string) ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' location 'hdfs:///user/insiderhack/HomeCredit/bureau_balance';"

hive -e "CREATE EXTERNAL TABLE IF NOT EXISTS home_credit_muhammadrizki.previous_application(SK_ID_PREV int, SK_ID_CURR int, NAME_CONTRACT_TYPE string, AMT_ANNUITY double, AMT_APPLICATION double, AMT_CREDIT double, AMT_DOWN_PAYMENT double, AMT_GOODS_PRICE double, WEEKDAY_APPR_PROCESS_START string, HOUR_APPR_PROCESS_START int, FLAG_LAST_APPL_PER_CONTRACT string, NFLAG_LAST_APPL_IN_DAY int, RATE_DOWN_PAYMENT double, RATE_INTEREST_PRIMARY double, RATE_INTEREST_PRIVILEGED double, NAME_CASH_LOAN_PURPOSE string, NAME_CONTRACT_STATUS string, DAYS_DECISION int, NAME_PAYMENT_TYPE string, CODE_REJECT_REASON string, NAME_TYPE_SUITE string, NAME_CLIENT_TYPE string, NAME_GOODS_CATEGORY string, NAME_PORTFOLIO string, NAME_PRODUCT_TYPE string, CHANNEL_TYPE string, SELLERPLACE_AREA int, NAME_SELLER_INDUSTRY string, CNT_PAYMENT double, NAME_YIELD_GROUP string, PRODUCT_COMBINATION string, DAYS_FIRST_DRAWING double, DAYS_FIRST_DUE double, DAYS_LAST_DUE_1ST_VERSION double, DAYS_LAST_DUE double, DAYS_TERMINATION double, NFLAG_INSURED_ON_APPROVAL double) ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' location 'hdfs:///user/insiderhack/HomeCredit/previous_application';"

hive -e "CREATE EXTERNAL TABLE IF NOT EXISTS home_credit_muhammadrizki.POS_CASH_balance(SK_ID_PREV int, SK_ID_CURR int, MONTHS_BALANCE int, CNT_INSTALMENT double, CNT_INSTALMENT_FUTURE double, NAME_CONTRACT_STATUS string, SK_DPD int, SK_DPD_DEF int) ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' location 'hdfs:///user/insiderhack/HomeCredit/POS_CASH_balance';"

hive -e "CREATE EXTERNAL TABLE IF NOT EXISTS home_credit_muhammadrizki.installments_payments(SK_ID_PREV int, SK_ID_CURR int, NUM_INSTALMENT_VERSION double, NUM_INSTALMENT_NUMBER int, DAYS_INSTALMENT double, DAYS_ENTRY_PAYMENT double, AMT_INSTALMENT double, AMT_PAYMENT double) ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' location 'hdfs:///user/insiderhack/HomeCredit/installments_payments';"

hive -e "CREATE EXTERNAL TABLE IF NOT EXISTS home_credit_muhammadrizki.credit_card_balance(SK_ID_PREV int, SK_ID_CURR int, MONTHS_BALANCE int, AMT_BALANCE double, AMT_CREDIT_LIMIT_ACTUAL int, AMT_DRAWINGS_ATM_CURRENT double, AMT_DRAWINGS_CURRENT double, AMT_DRAWINGS_OTHER_CURRENT double, AMT_DRAWINGS_POS_CURRENT double, AMT_INST_MIN_REGULARITY double, AMT_PAYMENT_CURRENT double, AMT_PAYMENT_TOTAL_CURRENT double, AMT_RECEIVABLE_PRINCIPAL double, AMT_RECIVABLE double, AMT_TOTAL_RECEIVABLE double, CNT_DRAWINGS_ATM_CURRENT double, CNT_DRAWINGS_CURRENT int, CNT_DRAWINGS_OTHER_CURRENT double, CNT_DRAWINGS_POS_CURRENT double, CNT_INSTALMENT_MATURE_CUM double, NAME_CONTRACT_STATUS string, SK_DPD int, SK_DPD_DEF int) ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' location 'hdfs:///user/insiderhack/HomeCredit/credit_card_balance';"

hive -e "CREATE EXTERNAL TABLE IF NOT EXISTS home_credit_muhammadrizki.final_table(SK_ID_CURR_fin int, TARGET int, NAME_CONTRACT_TYPE_fin string, CODE_GENDER string, FLAG_OWN_CAR string, FLAG_OWN_REALTY string, CNT_CHILDREN int, AMT_INCOME_TOTAL double, AMT_CREDIT_fin double, AMT_ANNUITY_apptr double, AMT_GOODS_PRICE_fin double, NAME_TYPE_SUITE_fin string, NAME_INCOME_TYPE string, NAME_EDUCATION_TYPE string, NAME_FAMILY_STATUS string, NAME_HOUSING_TYPE string, REGION_POPULATION_RELATIVE double, DAYS_BIRTH int, DAYS_EMPLOYED int, DAYS_REGISTRATION double, DAYS_ID_PUBLISH int, OWN_CAR_AGE double, FLAG_MOBIL int, FLAG_EMP_PHONE int, FLAG_WORK_PHONE int, FLAG_CONT_MOBILE int, FLAG_PHONE int, FLAG_EMAIL int, OCCUPATION_TYPE string, CNT_FAM_MEMBERS double, REGION_RATING_CLIENT int, REGION_RATING_CLIENT_W_CITY int, WEEKDAY_APPR_PROCESS_START_fin string, HOUR_APPR_PROCESS_START_fin int, REG_REGION_NOT_LIVE_REGION int, REG_REGION_NOT_WORK_REGION int, LIVE_REGION_NOT_WORK_REGION int, REG_CITY_NOT_LIVE_CITY int, REG_CITY_NOT_WORK_CITY int, LIVE_CITY_NOT_WORK_CITY int, ORGANIZATION_TYPE string, EXT_SOURCE_1 double, EXT_SOURCE_2 double, EXT_SOURCE_3 double, APARTMENTS_AVG double, BASEMENTAREA_AVG double, YEARS_BEGINEXPLUATATION_AVG double, YEARS_BUILD_AVG double, COMMONAREA_AVG double, ELEVATORS_AVG double, ENTRANCES_AVG double, FLOORSMAX_AVG double, FLOORSMIN_AVG double, LANDAREA_AVG double, LIVINGAPARTMENTS_AVG double, LIVINGAREA_AVG double, NONLIVINGAPARTMENTS_AVG double, NONLIVINGAREA_AVG double, APARTMENTS_MODE double, BASEMENTAREA_MODE double, YEARS_BEGINEXPLUATATION_MODE double, YEARS_BUILD_MODE double, COMMONAREA_MODE double, ELEVATORS_MODE double, ENTRANCES_MODE double, FLOORSMAX_MODE double, FLOORSMIN_MODE double, LANDAREA_MODE double, LIVINGAPARTMENTS_MODE double, LIVINGAREA_MODE double, NONLIVINGAPARTMENTS_MODE double, NONLIVINGAREA_MODE double, APARTMENTS_MEDI double, BASEMENTAREA_MEDI double, YEARS_BEGINEXPLUATATION_MEDI double, YEARS_BUILD_MEDI double, COMMONAREA_MEDI double, ELEVATORS_MEDI double, ENTRANCES_MEDI double, FLOORSMAX_MEDI double, FLOORSMIN_MEDI double, LANDAREA_MEDI double, LIVINGAPARTMENTS_MEDI double, LIVINGAREA_MEDI double, NONLIVINGAPARTMENTS_MEDI double, NONLIVINGAREA_MEDI double, FONDKAPREMONT_MODE string, HOUSETYPE_MODE string, TOTALAREA_MODE double, WALLSMATERIAL_MODE string, EMERGENCYSTATE_MODE string, OBS_30_CNT_SOCIAL_CIRCLE double, DEF_30_CNT_SOCIAL_CIRCLE double, OBS_60_CNT_SOCIAL_CIRCLE double, DEF_60_CNT_SOCIAL_CIRCLE double, DAYS_LAST_PHONE_CHANGE double, FLAG_DOCUMENT_2 int, FLAG_DOCUMENT_3 int, FLAG_DOCUMENT_4 int, FLAG_DOCUMENT_5 int, FLAG_DOCUMENT_6 int, FLAG_DOCUMENT_7 int, FLAG_DOCUMENT_8 int, FLAG_DOCUMENT_9 int, FLAG_DOCUMENT_10 int, FLAG_DOCUMENT_11 int, FLAG_DOCUMENT_12 int, FLAG_DOCUMENT_13 int, FLAG_DOCUMENT_14 int, FLAG_DOCUMENT_15 int, FLAG_DOCUMENT_16 int, FLAG_DOCUMENT_17 int, FLAG_DOCUMENT_18 int, FLAG_DOCUMENT_19 int, FLAG_DOCUMENT_20 int, FLAG_DOCUMENT_21 int, AMT_REQ_CREDIT_BUREAU_HOUR double, AMT_REQ_CREDIT_BUREAU_DAY double, AMT_REQ_CREDIT_BUREAU_WEEK double, AMT_REQ_CREDIT_BUREAU_MON double, AMT_REQ_CREDIT_BUREAU_QRT double, AMT_REQ_CREDIT_BUREAU_YEAR double, SK_ID_BUREAU double, CREDIT_ACTIVE string, CREDIT_CURRENCY string, DAYS_CREDIT double, CREDIT_DAY_OVERDUE double, DAYS_CREDIT_ENDDATE double, DAYS_ENDDATE_FACT double, AMT_CREDIT_MAX_OVERDUE double, CNT_CREDIT_PROLONG double, AMT_CREDIT_SUM double, AMT_CREDIT_SUM_DEBT double, AMT_CREDIT_SUM_LIMIT double, AMT_CREDIT_SUM_OVERDUE double, CREDIT_TYPE string, DAYS_CREDIT_UPDATE double, AMT_ANNUITY_br double, MONTHS_BALANCE_fin double, STATUS string, SK_ID_PREV double, NAME_CONTRACT_TYPE_preapp string, AMT_ANNUITY double, AMT_APPLICATION double, AMT_CREDIT_preapp double, AMT_DOWN_PAYMENT double, AMT_GOODS_PRICE_preapp double, WEEKDAY_APPR_PROCESS_START_preapp string, HOUR_APPR_PROCESS_START_preapp double, FLAG_LAST_APPL_PER_CONTRACT string, NFLAG_LAST_APPL_IN_DAY double, RATE_DOWN_PAYMENT double, RATE_INTEREST_PRIMARY double, RATE_INTEREST_PRIVILEGED double, NAME_CASH_LOAN_PURPOSE string, NAME_CONTRACT_STATUS_fin string, DAYS_DECISION double, NAME_PAYMENT_TYPE string, CODE_REJECT_REASON string, NAME_TYPE_SUITE_preapp string, NAME_CLIENT_TYPE string, NAME_GOODS_CATEGORY string, NAME_PORTFOLIO string, NAME_PRODUCT_TYPE string, CHANNEL_TYPE string, SELLERPLACE_AREA double, NAME_SELLER_INDUSTRY string, CNT_PAYMENT double, NAME_YIELD_GROUP string, PRODUCT_COMBINATION string, DAYS_FIRST_DRAWING double, DAYS_FIRST_DUE double, DAYS_LAST_DUE_1ST_VERSION double, DAYS_LAST_DUE double, DAYS_TERMINATION double, NFLAG_INSURED_ON_APPROVAL double, SK_ID_CURR_pcb double, MONTHS_BALANCE_pcb double, CNT_INSTALMENT double, CNT_INSTALMENT_FUTURE double, NAME_CONTRACT_STATUS_pcb string, SK_DPD_fin double, SK_DPD_DEF_fin double, SK_ID_CURR_finn double, NUM_INSTALMENT_VERSION double, NUM_INSTALMENT_NUMBER double, DAYS_INSTALMENT double, DAYS_ENTRY_PAYMENT double, AMT_INSTALMENT double, AMT_PAYMENT double, SK_ID_CURR_ccb double, MONTHS_BALANCE double, AMT_BALANCE double, AMT_CREDIT_LIMIT_ACTUAL double, AMT_DRAWINGS_ATM_CURRENT double, AMT_DRAWINGS_CURRENT double, AMT_DRAWINGS_OTHER_CURRENT double, AMT_DRAWINGS_POS_CURRENT double, AMT_INST_MIN_REGULARITY double, AMT_PAYMENT_CURRENT double, AMT_PAYMENT_TOTAL_CURRENT double, AMT_RECEIVABLE_PRINCIPAL double, AMT_RECIVABLE double, AMT_TOTAL_RECEIVABLE double, CNT_DRAWINGS_ATM_CURRENT double, CNT_DRAWINGS_CURRENT double, CNT_DRAWINGS_OTHER_CURRENT double, CNT_DRAWINGS_POS_CURRENT double, CNT_INSTALMENT_MATURE_CUM double, NAME_CONTRACT_STATUS string, SK_DPD_ccb double, SK_DPD_DEF_ccb double) ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' location 'hdfs:///user/insiderhack/HomeCredit/final_table';"

###############################################################################

# ############# ############# #############
# ##       TIME TO RUN THE SCRIPT        ##
# ##                                     ##
# ## You shouldn't need to edit anything ##
# ## beneath this line                   ##
# ##                                     ##
# ############# ############# #############

echo ""
echo ""
echo -e "Muhammad Rizki █▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀█"
echo -e "█                     » HOME Credit Sqooping «                     █"
echo -e "█▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ v-0.0.1 ▄▄▄█ Muhammad Rizki"
echo ""
echo "     Sqooping IS The Another Level Store Data    "
echo ""
